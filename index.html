<!DOCTYPE html>
<html>
  <head>
    <title>Poker App</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <h1>Poker App</h1>

    <!-- Join Form -->
    <input id="playerName" placeholder="Enter your name" />
    <button id="joinBtn">Join</button>

    <!-- Player List -->
    <h2>Players in Lobby:</h2>
    <ul id="playersList"></ul>

    <script type="module">
      // Import Firebase
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
      import { 
        getFirestore, collection, addDoc, onSnapshot 
      } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

      // Your Firebase config
      const firebaseConfig = {
        apiKey: "AIzaSyBiurHUaSI9ytpiTLps9MqY4QHF4MbEt24",
        authDomain: "jojo-pokler.firebaseapp.com",
        projectId: "jojo-pokler",
        storageBucket: "jojo-pokler.firebasestorage.app",
        messagingSenderId: "963260398028",
        appId: "1:963260398028:web:ce28df14ea78042e968569",
        measurementId: "G-V78WWQ0VZQ"
      };

      // Init Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Join button logic
      document.getElementById("joinBtn").addEventListener("click", async () => {
        const name = document.getElementById("playerName").value.trim();
        if (!name) {
          alert("Enter a name first!");
          return;
        }

        try {
          const docRef = await addDoc(collection(db, "players"), {
            name: name,
            joinedAt: new Date()
          });
          console.log("✅ Player added:", docRef.id);
          alert(`Welcome, ${name}!`);
        } catch (e) {
          console.error("❌ Error adding player:", e);
        }
      });

      // Listen for players live
      const playersList = document.getElementById("playersList");
      onSnapshot(collection(db, "players"), (snapshot) => {
        playersList.innerHTML = "";
        snapshot.forEach((doc) => {
          const li = document.createElement("li");
          li.textContent = doc.data().name;
          playersList.appendChild(li);
        });
      });
    </script>
  </body>
</html>
