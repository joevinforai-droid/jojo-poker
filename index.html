<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jojo Poker</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBiurHUaSI9ytpiTLps9MqY4QHF4MbEt24",
  authDomain: "jojo-pokler.firebaseapp.com",
  projectId: "jojo-pokler",
  storageBucket: "jojo-pokler.firebasestorage.app",
  messagingSenderId: "963260398028",
  appId: "1:963260398028:web:ce28df14ea78042e968569"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const nameInput = document.getElementById("nameInput");
const joinBtn = document.getElementById("joinBtn");
const holeCardsDiv = document.getElementById("holeCardsDiv");
const adminDiv = document.getElementById("adminDiv");

const sessionDoc = doc(db, "sessions", "current");

joinBtn.addEventListener("click", async () => {
  const name = nameInput.value.trim();
  if (!name) return alert("Enter your name!");

  try {
    const sessionSnap = await getDoc(sessionDoc);
    let sessionData = sessionSnap.exists() ? sessionSnap.data() : {};
    const players = sessionData.players || [];
    if (!players.includes(name)) players.push(name);

    await setDoc(sessionDoc, { 
      players, 
      holeCards: {}, 
      board: { flop: ["", "", ""], turn: "", river: "" }
    });

    alert(`✅ Joined lobby as ${name}`);
    holeCardsDiv.style.display = "block";
    adminDiv.style.display = "block";
  } catch(e) {
    console.error("Error joining lobby:", e);
    alert("❌ Failed to join lobby. Check console for errors.");
  }
});
</script>
</head>
<body>
<h1>Jojo Poker Lobby</h1>
<input id="nameInput" placeholder="Enter your name" />
<button id="joinBtn">Join Lobby</button>

<div id="holeCardsDiv" style="display:none;">
  <h2>Your Hole Cards (placeholder)</h2>
</div>

<div id="adminDiv" style="display:none;">
  <h2>Admin View (placeholder)</h2>
</div>
</body>
</html>
